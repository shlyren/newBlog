<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>const,static,extern简介 · 任玉祥</title><meta name="description" content="const,static,extern简介 - 任玉祥"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="https://source.yuxiang.ren/favicon_yuxiang.ico"><link rel="stylesheet" href="/css/gandalfr.css"><link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/solarized-light.css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="https://ww3.sinaimg.cn/large/006tNc79gy1fe3u2mby1ij30400403z5.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="https://github.com/shlyren" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://twitter.com/shlyren" target="_blank" class="nav-list-link">推特</a></li><li class="nav-list-item"><a href="http://weibo.com/shlyjen" target="_blank" class="nav-list-link">微博</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">关于</a></li><li class="nav-list-item"><a href="mailto:mail@yuxiang.ren" target="_self" class="nav-list-link">邮箱</a></li><li class="nav-list-item"><a href="https://google.yuxiang.ren" target="_blank" class="nav-list-link">GOOGLE</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">const,static,extern简介</h1><div class="tags"></div><div class="post-info">Mar 26, 2016</div><div class="post-content"><h2 id="const与宏的区别-面试题"><a href="#const与宏的区别-面试题" class="headerlink" title="const与宏的区别(面试题):"></a>const与宏的区别(面试题):</h2><ol>
<li><code>const</code>简介:之前常用的字符串常量,一般是抽成宏,但是苹果不推荐我们抽成宏,推荐我们使用const常量.<br>主要是因为以下四点:<ul>
<li><code>编译时刻</code>:<strong>宏</strong>是预编译,<strong>const</strong>是编译阶段.</li>
<li><code>编译检查</code>:<strong>宏</strong>不做检查,不会报编译错误,只是替换,<strong>const</strong>会编译检查,会报编译错误.</li>
<li><code>宏的好处</code>:宏能定义一些函数,方法,const不能.</li>
<li><code>宏的坏处</code>:使用大量红,容易造成编译时间久,每次都需要重新替换.</li>
</ul>
</li>
</ol>
<a id="more"></a>
<p>　　<strong>注意:</strong>很多blog都说使用宏会消耗很多内存,但我这验证并不会生成很多内存,宏定义的是常量,常量都放在常量区,只会产生一份内存.</p>
<h2 id="const"><a href="#const" class="headerlink" title="const"></a>const</h2><ol>
<li><strong>const作用</strong>:const的作用是用来限制类型的.<ul>
<li>const仅仅用来修饰右边的变量(基本数据类型p,指针变量*p);</li>
<li>被const修饰的变量是只读的.</li>
</ul>
</li>
<li><p>const基本使用</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">   [<span class="keyword">super</span> viewDidLoad];</div><div class="line">   <span class="keyword">int</span> a = <span class="number">1</span>;</div><div class="line">   a = <span class="number">20</span>;</div><div class="line">   <span class="keyword">const</span> <span class="keyword">int</span> b = <span class="number">20</span>; <span class="comment">// b:只读变量</span></div><div class="line">   <span class="keyword">int</span> <span class="keyword">const</span> b = <span class="number">20</span>; <span class="comment">// b:只读变量</span></div><div class="line">   b = <span class="number">1</span>;  <span class="comment">// 不允许修改值</span></div><div class="line">   </div><div class="line">   <span class="comment">// const:修饰指针变量*p，带*的变量，就是指针变量.</span></div><div class="line">   <span class="comment">// 定义一个指向int类型的指针变量，指向a的地址</span></div><div class="line">   <span class="keyword">int</span> *p = &amp;a;</div><div class="line">   <span class="keyword">int</span> c = <span class="number">10</span>;</div><div class="line">   p = &amp;c;<span class="comment">// 允许修改p指向的地址，</span></div><div class="line">   *p = <span class="number">20</span>;  <span class="comment">// 允许修改p访问内存空间的值</span></div><div class="line">   </div><div class="line">   <span class="comment">// 两种方式一样,const修饰指针变量访问的内存空间，修饰的是右边*p1，</span></div><div class="line">   <span class="keyword">const</span> <span class="keyword">int</span> *p1; <span class="comment">// *p1：常量 p1:变量</span></div><div class="line">   <span class="keyword">int</span> <span class="keyword">const</span> *p1; <span class="comment">// *p1：常量 p1:变量</span></div><div class="line"></div><div class="line">   <span class="comment">// const修饰指针变量p1</span></div><div class="line">   <span class="keyword">int</span> * <span class="keyword">const</span> p1; <span class="comment">// *p1:变量 p1:常量</span></div><div class="line"></div><div class="line">   <span class="comment">// 两种方式一样,第一个const修饰*p1 第二个const修饰 p1</span></div><div class="line">   <span class="keyword">const</span> <span class="keyword">int</span> * <span class="keyword">const</span> p1; <span class="comment">// *p1：常量 p1：常量</span></div><div class="line">   <span class="keyword">int</span> <span class="keyword">const</span> * <span class="keyword">const</span> p1;  <span class="comment">// *p1：常量 p1：常量</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>const开发中的使用场景</p>
<ul>
<li>当一个方法参数只读</li>
<li>定义只读全局变量</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定义只读全局常量</span></div><div class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> str  = <span class="string">@"123"</span>;</div><div class="line"><span class="comment">// 当一个方法的参数，只读.</span></div><div class="line">- (<span class="keyword">void</span>)test:(<span class="built_in">NSString</span> * <span class="keyword">const</span>)name;</div><div class="line"><span class="comment">// 指针只读,不能通过指针修改值</span></div><div class="line">- (<span class="keyword">void</span>)test1:(<span class="keyword">int</span> <span class="keyword">const</span> *)a;</div><div class="line"><span class="comment">// 基本数据类型只读</span></div><div class="line">- (<span class="keyword">void</span>)test2:(<span class="keyword">int</span> <span class="keyword">const</span>)a;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="static和extern的简单使用"><a href="#static和extern的简单使用" class="headerlink" title="static和extern的简单使用"></a>static和extern的简单使用</h2><ol>
<li><strong>static作用</strong><ul>
<li>修饰局部变量:<ol>
<li>延长局部变量的什么周期:程序结束才会销毁</li>
<li>局部变量只会生成一份内存,只会初始化一次.</li>
</ol>
</li>
<li>修饰全局变量<ol>
<li>只能在本文件中访问,修改全局变量的作用域,生命周期不会改.</li>
</ol>
</li>
</ul>
</li>
<li><strong>extern作用</strong><ul>
<li>只是用来获取全局变量(包括全局静态变量)的值, 不能用于定义变量.</li>
</ul>
</li>
<li><strong>entern原理</strong><ul>
<li>现在当前文件查找有没有全局变量,没有找到,才会其他文件查找.</li>
</ul>
</li>
<li>代码演示<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> a = <span class="number">20</span>;<span class="comment">// 全局变量：只有一份内存，所有文件共享，与extern联合使用。</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">int</span> age = <span class="number">20</span>;<span class="comment">// static修饰全局变量</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)test</div><div class="line">&#123;</div><div class="line">     <span class="comment">// static修饰局部变量</span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">int</span> age = <span class="number">0</span>;</div><div class="line">    age++;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%d"</span>,age);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    [<span class="keyword">self</span> test];</div><div class="line"></div><div class="line">    <span class="keyword">extern</span> <span class="keyword">int</span> age;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%d"</span>,age);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="static与const联合使用"><a href="#static与const联合使用" class="headerlink" title="static与const联合使用"></a>static与const联合使用</h2><ol>
<li><strong>static与const作用:</strong>声明一个只读的静态变量</li>
<li><strong>开发场景:</strong>在<code>一个文件中</code>经常使用的字符串常量,可以使用static与const组合.<ul>
<li>开发中常用static修饰全局变量,只改变作用域</li>
<li>为什么要改变全局变量作用域? 防止重复声明全局变量。</li>
<li>开发中声明的全局变量，有些不希望外界改动，只允许读取。比如一个基本数据类型不希望别人改动<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 声明一个静态的全局只读常量</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> a = <span class="number">20</span>;</div><div class="line"><span class="comment">// 开发中经常拿到key修改值，因此用const修饰key,表示key只读，不允许修改。</span></div><div class="line"><span class="keyword">static</span>  <span class="built_in">NSString</span> * <span class="keyword">const</span> key = <span class="string">@"name"</span>;</div><div class="line"><span class="comment">// 如果 const修饰 *key1,表示*key1只读，key1还是能改变。</span></div><div class="line"><span class="keyword">static</span>  <span class="built_in">NSString</span> <span class="keyword">const</span> *key1 = <span class="string">@"name"</span>;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<h2 id="extern与const联合使用"><a href="#extern与const联合使用" class="headerlink" title="extern与const联合使用"></a>extern与const联合使用</h2><ol>
<li>开发使用场景:<ul>
<li>在<strong>多个文件中</strong>经常使用的同一个字符串常量,可以使用extern与const组合</li>
</ul>
</li>
<li>原因:<ul>
<li><strong>static与const组合</strong>:在每个文件中都需要定义一份静态全局变量.</li>
<li><strong>entern与const组合</strong>:只需定义一份全局变量,多个文件共享.</li>
</ul>
</li>
<li>示例代码<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// .h文件中</span></div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> nameKey = <span class="string">@"name"</span>;</div><div class="line"><span class="comment">//.m文件中</span></div><div class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> nameKey = <span class="string">@"name"</span>;</div></pre></td></tr></table></figure>
</li>
</ol>
</div></article></div></main><footer><div class="paginator"><a href="/2016/03/26/IOS学习之作业篇(OC)/" class="prev">PREV</a><a href="/2016/03/26/runtime/" class="next">NEXT</a></div><div data-thread-key="2016/03/26/const-static-extern简介/" data-title="const,static,extern简介" data-url="https://yuxiang.ren/2016/03/26/const-static-extern简介/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"shlyren"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div id="disqus_thread"></div><script>var disqus_shortname = 'shlyren';
var disqus_identifier = '2016/03/26/const-static-extern简介/';
var disqus_title = 'const,static,extern简介';
var disqus_url = 'https://yuxiang.ren/2016/03/26/const-static-extern简介/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//shlyren.disqus.com/count.js" async></script><div class="copyright"><p>Copyright © 2016 - 2017 <a href="https://yuxiang.ren">任玉祥</a>. All rights reserved.</p><p>View the source code in <a href="https://github.com/shlyren/web/tree/master/yuxiang.ren" target="_blank">GitHub</a></p><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1259844339'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1259844339%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script></div></footer></div><script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" crossorigin="anonymous"></script><script src="//cdn.bootcss.com/jquery/3.1.1/jquery.js" crossorigin="anonymous"></script><script>$(document).ready(function() { $('pre').each(function(i, block) { hljs.highlightBlock(block); }); });</script></body></html>